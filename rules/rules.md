# Architecture & RÃ¨gles de Projet

Ce document est le guide de rÃ©fÃ©rence unique pour la structure du projet. Son respect est impÃ©ratif pour garantir la cohÃ©rence et la maintenabilitÃ©.

## 1. Arborescence ComplÃ¨te du Projet

L'architecture est modulaire. Elle est composÃ©e de **FonctionnalitÃ©s** autonomes (ex: `dashboard`) et d'un rÃ©pertoire **PartagÃ©** (`_shared`).

```
â”œâ”€ prisma/                      # DATABASE - Configuration Prisma (OBLIGATOIRE Ã  la racine)
â”‚  â””â”€ schema.prisma             # DATABASE - SchÃ©ma de base de donnÃ©es avec modÃ¨les
â”œâ”€ src/app/                     # APPLICATION - Code source principal
â”‚  â”œâ”€ _shared/                  # CODE PARTAGÃ‰ Ã€ TOUTE L'APPLICATION
â”‚  â”‚  â”œâ”€ components/            # Composants UI gÃ©nÃ©riques rÃ©utilisables
â”‚  â”‚  â”‚  â”œâ”€ SessionProvider.tsx # AUTH - Provider NextAuth pour client
â”‚  â”‚  â”‚  â”œâ”€ ThemeProvider.tsx   # THEME - Provider pour le thÃ¨me
â”‚  â”‚  â”‚  â”œâ”€ ThemeToggle.tsx     # THEME - Bouton pour changer de thÃ¨me
â”‚  â”‚  â”‚  â”œâ”€ button.tsx          # UI - Composant bouton de base
â”‚  â”‚  â”‚  â”œâ”€ ExempleComposant1.tsx # EXEMPLE - Composant rÃ©utilisable 1
â”‚  â”‚  â”‚  â””â”€ ExempleComposant2.tsx # EXEMPLE - Composant rÃ©utilisable 2
â”‚  â”‚  â”œâ”€ database/              # DATABASE - Gestion base de donnÃ©es avec Prisma
â”‚  â”‚  â”‚  â”œâ”€ client.ts           # DATABASE - Client Prisma principal (singleton)
â”‚  â”‚  â”‚  â”œâ”€ types.ts            # DATABASE - Types de base de donnÃ©es et utilitaires
â”‚  â”‚  â”‚  â””â”€ queries/            # DATABASE - RequÃªtes organisÃ©es par modÃ¨le
â”‚  â”‚  â”‚     â”œâ”€ user.ts          # DATABASE - RequÃªtes CRUD pour les utilisateurs
â”‚  â”‚  â”‚     â””â”€ [model].ts       # DATABASE - Exemple - RequÃªtes pour autres modÃ¨les
â”‚  â”‚  â”œâ”€ hooks/                 # Hooks React globaux
â”‚  â”‚  â”‚  â”œâ”€ useAuth.ts          # AUTH - Hook principal d'authentification
â”‚  â”‚  â”‚  â”œâ”€ useDatabase.ts      # DATABASE - Hook pour opÃ©rations base de donnÃ©es
â”‚  â”‚  â”‚  â”œâ”€ ExempleHook1.ts     # EXEMPLE - Hook global 1
â”‚  â”‚  â”‚  â””â”€ ExempleHook2.ts     # EXEMPLE - Hook global 2
â”‚  â”‚  â”œâ”€ lib/                   # Fonctions utilitaires partagÃ©es
â”‚  â”‚  â”‚  â”œâ”€ auth.ts             # AUTH - Configuration NextAuth avec adapter Prisma
â”‚  â”‚  â”‚  â”œâ”€ utils.ts            # UI - Fonctions utilitaires (ex: cn pour classnames)
â”‚  â”‚  â”‚  â”œâ”€ ExempleLib1.ts      # EXEMPLE - Utilitaire partagÃ© 1
â”‚  â”‚  â”‚  â””â”€ ExempleLib2.ts      # EXEMPLE - Utilitaire partagÃ© 2
â”‚  â”‚  â””â”€ types/                 # Types TypeScript partagÃ©s
â”‚  â”‚     â”œâ”€ auth.ts             # AUTH - Types d'authentification Ã©tendus
â”‚  â”‚     â”œâ”€ common.ts           # EXEMPLE - Types communs
â”‚  â”‚     â””â”€ api.ts              # EXEMPLE - Types d'API partagÃ©s
â”‚  â”‚
â”‚  â”œâ”€ api/                      # TOUTES LES APIs DE L'APPLICATION (Next.js App Router)
â”‚  â”‚  â”œâ”€ auth/                  # AUTH - APIs NextAuth (OBLIGATOIRE)
â”‚  â”‚  â”‚  â””â”€ [...nextauth]/      # AUTH - Route NextAuth dynamique
â”‚  â”‚  â”‚     â””â”€ route.ts         # AUTH - Handler NextAuth avec Google Provider
â”‚  â”‚  â”œâ”€ users/                 # DATABASE - APIs pour gestion utilisateurs
â”‚  â”‚  â”‚  â””â”€ route.ts            # DATABASE - Endpoints CRUD utilisateurs avec auth
â”‚  â”‚  â””â”€ dashboard/             # EXEMPLE - APIs pour la page principale
â”‚  â”‚     â”œâ”€ route.ts            # EXEMPLE - Endpoints page principale
â”‚  â”‚     â”œâ”€ services.ts         # EXEMPLE - Logique mÃ©tier page principale
â”‚  â”‚     â”œâ”€ types.ts            # EXEMPLE - Types spÃ©cifiques page principale
â”‚  â”‚     â””â”€ settings/           # EXEMPLE - APIs pour la sous-page
â”‚  â”‚        â”œâ”€ route.ts         # EXEMPLE - Endpoints sous-page
â”‚  â”‚        â”œâ”€ services.ts      # EXEMPLE - Logique mÃ©tier sous-page
â”‚  â”‚        â””â”€ types.ts         # EXEMPLE - Types spÃ©cifiques sous-page
â”‚  â”‚
â”‚  â”œâ”€ login/                    # AUTH - PAGE DE CONNEXION (Route: /login)
â”‚  â”‚  â”œâ”€ components/            # Composants SPÃ‰CIFIQUES Ã  la page login
â”‚  â”‚  â”‚  â”œâ”€ LoginButton.tsx     # AUTH - Bouton "Connexion avec Google"
â”‚  â”‚  â”‚  â”œâ”€ ExempleComposant1.tsx # EXEMPLE - Composant login 1
â”‚  â”‚  â”‚  â””â”€ ExempleComposant2.tsx # EXEMPLE - Composant login 2
â”‚  â”‚  â”œâ”€ hooks/                 # Hooks SPÃ‰CIFIQUES Ã  la page login
â”‚  â”‚  â”‚  â”œâ”€ ExempleHook1.ts     # EXEMPLE - Hook login 1
â”‚  â”‚  â”‚  â””â”€ ExempleHook2.ts     # EXEMPLE - Hook login 2
â”‚  â”‚  â”œâ”€ lib/                   # Libs SPÃ‰CIFIQUES Ã  la page login
â”‚  â”‚  â”‚  â”œâ”€ ExempleLib1.ts      # EXEMPLE - Lib login 1
â”‚  â”‚  â”‚  â””â”€ ExempleLib2.ts      # EXEMPLE - Lib login 2
â”‚  â”‚  â”œâ”€ page.tsx               # AUTH - Page de connexion principale
â”‚  â”‚  â””â”€ types.ts               # AUTH - Types spÃ©cifiques Ã  login
â”‚  â”‚
â”‚  â”œâ”€ dashboard/                # EXEMPLE DE FONCTIONNALITÃ‰ (Route: /dashboard) - PROTÃ‰GÃ‰E
â”‚  â”‚  â”œâ”€ components/            # Composants SPÃ‰CIFIQUES Ã  la page principale
â”‚  â”‚  â”‚  â”œâ”€ ExempleComposant1.tsx # EXEMPLE - Composant dashboard 1
â”‚  â”‚  â”‚  â””â”€ ExempleComposant2.tsx # EXEMPLE - Composant dashboard 2
â”‚  â”‚  â”œâ”€ hooks/                 # Hooks SPÃ‰CIFIQUES au dashboard
â”‚  â”‚  â”‚  â”œâ”€ ExempleHook1.ts     # EXEMPLE - Hook dashboard 1
â”‚  â”‚  â”‚  â””â”€ ExempleHook2.ts     # EXEMPLE - Hook dashboard 2
â”‚  â”‚  â”œâ”€ lib/                   # Libs SPÃ‰CIFIQUES au dashboard
â”‚  â”‚  â”‚  â”œâ”€ ExempleLib1.ts      # EXEMPLE - Lib dashboard 1
â”‚  â”‚  â”‚  â””â”€ ExempleLib2.ts      # EXEMPLE - Lib dashboard 2
â”‚  â”‚  â”œâ”€ settings/              # EXEMPLE - SOUS-PAGE (Route: /dashboard/settings) - PROTÃ‰GÃ‰E
â”‚  â”‚  â”‚  â”œâ”€ components/         # Composants SPÃ‰CIFIQUES Ã  la sous-page
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ExempleComposant1.tsx # EXEMPLE - Composant settings 1
â”‚  â”‚  â”‚  â”‚  â””â”€ ExempleComposant2.tsx # EXEMPLE - Composant settings 2
â”‚  â”‚  â”‚  â”œâ”€ hooks/              # Hooks SPÃ‰CIFIQUES Ã  la sous-page
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ExempleHook1.ts  # EXEMPLE - Hook settings 1
â”‚  â”‚  â”‚  â”‚  â””â”€ ExempleHook2.ts  # EXEMPLE - Hook settings 2
â”‚  â”‚  â”‚  â”œâ”€ lib/                # Libs SPÃ‰CIFIQUES Ã  la sous-page
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ExempleLib1.ts   # EXEMPLE - Lib settings 1
â”‚  â”‚  â”‚  â”‚  â””â”€ ExempleLib2.ts   # EXEMPLE - Lib settings 2
â”‚  â”‚  â”‚  â”œâ”€ page.tsx            # EXEMPLE - Page de la sous-page
â”‚  â”‚  â”‚  â””â”€ types.ts            # EXEMPLE - Types spÃ©cifiques Ã  settings
â”‚  â”‚  â”œâ”€ page.tsx               # EXEMPLE - Page principale
â”‚  â”‚  â”œâ”€ layout.tsx             # EXEMPLE - Layout pour toute la fonctionnalitÃ©
â”‚  â”‚  â””â”€ types.ts               # EXEMPLE - Types spÃ©cifiques Ã  dashboard
â”‚  â”‚
â”‚  â”œâ”€ globals.css               # Styles globaux de l'application
â”‚  â”œâ”€ layout.tsx                # ROOT - Layout principal avec SessionProvider
â”‚  â””â”€ page.tsx                  # ROOT - Page d'accueil (redirige selon auth)
â”œâ”€ middleware.ts                # AUTH - Protection des routes (/dashboard/*) (OBLIGATOIRE Ã  la racine)
â”œâ”€ docker-compose.yml           # DATABASE - Configuration PostgreSQL + pgAdmin
â”œâ”€ .env                         # CONFIG - Variables d'environnement (sensibles)
â”œâ”€ .env.example                 # CONFIG - Template des variables d'environnement
â”œâ”€ .gitignore                   # CONFIG - Fichiers ignorÃ©s par Git
â”œâ”€ package.json                 # CONFIG - DÃ©pendances et scripts npm
â”œâ”€ tsconfig.json                # CONFIG - Configuration TypeScript  
â”œâ”€ next.config.ts               # CONFIG - Configuration Next.js
â”œâ”€ tailwind.config.ts           # CONFIG - Configuration Tailwind CSS
â”œâ”€ postcss.config.mjs           # CONFIG - Configuration PostCSS
â”œâ”€ rules/                       # DOC - Documentation et rÃ¨gles du projet
â”‚  â”œâ”€ rules.md                  # DOC - Architecture et conventions (ce fichier)
â”‚  â””â”€ tech-stack.md             # DOC - Stack technique dÃ©taillÃ©
â””â”€ README.md                    # DOC - Documentation du projet
```

---

## 2. Convention de Nommage des Fichiers

Pour une fonctionnalitÃ© `[nom]`, respecter cette convention stricte :

### **Hooks React :**
- **Format :** `use[Nom].ts` (PascalCase aprÃ¨s "use")
- **Exemples :** `useAuth.ts`, `useDashboard.ts`, `useUser.ts`
- **RÃ¨gle :** TOUJOURS commencer par "use" (convention React obligatoire)

### **Librairies/Utilitaires :**
- **Format :** `[nom].ts` (camelCase)
- **Exemples :** `auth.ts`, `dashboard.ts`, `user.ts`
- **RÃ¨gle :** Nom simple et explicite de la fonctionnalitÃ©

### **Types TypeScript :**
- **Format :** `[nom].ts` (camelCase)
- **Exemples :** `auth.ts`, `dashboard.ts`, `user.ts`
- **RÃ¨gle :** MÃªme nom que le fichier lib correspondant

### **Exemple complet pour une fonctionnalitÃ© "user-management" :**
```
user-management/
â”œâ”€ hooks/useUser.ts          # Hook pour gestion utilisateurs
â”œâ”€ lib/user.ts               # Fonctions utilitaires utilisateurs
â””â”€ types.ts                  # Types spÃ©cifiques Ã  user-management
```

---

## 3. Configuration Authentification (Better Auth + Providers OAuth)

### **ðŸ”¥ Template Better Auth - Copy/Paste Ready**

### **Variables d'environnement (.env) :**
```env
# Better Auth Configuration
BETTER_AUTH_SECRET=your-64-char-secret-key
BETTER_AUTH_URL=http://localhost:3000
NEXT_PUBLIC_BETTER_AUTH_URL=http://localhost:3000

# OAuth Providers (optionnel - ajouter selon besoins)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GITHUB_CLIENT_ID=your-github-client-id  
GITHUB_CLIENT_SECRET=your-github-client-secret
```

### **Architecture Better Auth - 4 fichiers essentiels :**
1. **`_shared/lib/auth.ts`** â†’ Configuration serveur Better Auth
2. **`_shared/lib/auth-client.ts`** â†’ Client Better Auth + hooks
3. **`api/auth/[...all]/route.ts`** â†’ Handler API Better Auth  
4. **`middleware.ts`** â†’ Protection routes cÃ´tÃ© serveur
5. **`_shared/components/AuthGuard.tsx`** â†’ Protection routes cÃ´tÃ© client (optionnel)

### **Template Better Auth - Configuration complÃ¨te :**

#### **1. Configuration serveur (_shared/lib/auth.ts) :**
```typescript
import { betterAuth } from "better-auth"
import { prismaAdapter } from "better-auth/adapters/prisma"
import { PrismaClient } from "@prisma/client"

const prisma = new PrismaClient()

export const auth = betterAuth({
  database: prismaAdapter(prisma, { provider: "postgresql" }),
  baseURL: process.env.BETTER_AUTH_URL || "http://localhost:3000",
  secret: process.env.BETTER_AUTH_SECRET!,
  socialProviders: {
    google: {
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
      scope: ["openid", "email", "profile"],
      mapProfileToUser: (profile) => ({
        id: profile.sub,
        email: profile.email,
        name: profile.name,
        image: profile.picture,
        emailVerified: profile.email_verified,
      })
    },
  },
  session: { expiresIn: 60 * 60 * 24 * 7, updateAge: 60 * 60 * 24 },
  advanced: { useSecureCookies: process.env.NODE_ENV === "production" },
  rateLimit: {
    window: 60, max: 100,
    customRules: { "/sign-in/*": { window: 60, max: 5 } }
  },
})

export type Session = typeof auth.$Infer.Session
export type User = typeof auth.$Infer.Session.user
```

#### **2. Client Better Auth (_shared/lib/auth-client.ts) :**
```typescript
"use client"
import { createAuthClient } from "better-auth/react"

// Client Better Auth avec toutes les mÃ©thodes
export const authClient = createAuthClient({
  baseURL: process.env.NEXT_PUBLIC_BETTER_AUTH_URL || "http://localhost:3000",
})

// Export de toutes les mÃ©thodes Better Auth
export const {
  signIn, signOut, signUp, useSession, getSession,
  updateUser, changePassword, forgetPassword, resetPassword,
} = authClient

// Types auto-infÃ©rÃ©s Better Auth
export type Session = typeof authClient.$Infer.Session
export type User = typeof authClient.$Infer.Session.user

// Hook personnalisÃ© simplifiÃ© (optionnel)
export function useAuth() {
  const { data: session, isPending: isLoading, error } = useSession()
  return {
    user: session?.user || null,
    session: session || null,
    isLoading,
    isAuthenticated: !!session?.user,
    error,
  }
}
```

#### **3. Route API (api/auth/[...all]/route.ts) :**
```typescript
import { auth } from "../../../_shared/lib/auth"
import { toNextJsHandler } from "better-auth/next-js"

const { GET, POST } = toNextJsHandler(auth)
export { GET, POST }
```

#### **4. Middleware (middleware.ts) :**
```typescript
import { NextRequest, NextResponse } from "next/server"

const PROTECTED_ROUTES = ["/dashboard"]

export async function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl
  const isProtectedRoute = PROTECTED_ROUTES.some(route => pathname.startsWith(route))

  if (isProtectedRoute) {
    try {
      const sessionResponse = await fetch(
        new URL("/api/auth/get-session", request.url),
        { headers: { cookie: request.headers.get("cookie") || "" } }
      )
      
      if (!sessionResponse.ok) {
        return NextResponse.redirect(new URL("/login", request.url))
      }
      
      const session = await sessionResponse.json()
      if (!session?.user) {
        return NextResponse.redirect(new URL("/login", request.url))
      }
    } catch (error) {
      return NextResponse.redirect(new URL("/login", request.url))
    }
  }
  
  return NextResponse.next()
}

export const config = {
  matcher: ["/((?!api|_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)"]
}
```

#### **5. AuthGuard Component (optionnel) :**
```typescript
"use client"
import { useEffect } from "react"
import { useRouter, usePathname } from "next/navigation"
import { useAuth } from "../lib/auth-client"

export function AuthGuard({ children }: { children: React.ReactNode }) {
  const { isAuthenticated, isLoading } = useAuth()
  const router = useRouter()
  const pathname = usePathname()

  useEffect(() => {
    if (isLoading) return
    if (!isAuthenticated && pathname !== "/login") {
      router.push("/login")
    }
    if (isAuthenticated && pathname === "/login") {
      router.push("/dashboard")
    }
  }, [isAuthenticated, isLoading, pathname, router])

  if (isLoading || (!isAuthenticated && pathname !== "/login")) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
      </div>
    )
  }

  return <>{children}</>
}
```

---

### **ðŸš€ Configuration AvancÃ©e Better Auth**

#### **Multi-Providers OAuth :**
```typescript
// Dans auth.ts - Support Google, GitHub, Discord
socialProviders: {
  google: {
    clientId: process.env.GOOGLE_CLIENT_ID!,
    clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    scope: ["openid", "email", "profile"],
    mapProfileToUser: (profile) => ({
      id: profile.sub,
      email: profile.email,
      name: profile.name,
      image: profile.picture,
      emailVerified: profile.email_verified,
    })
  },
  github: {
    clientId: process.env.GITHUB_CLIENT_ID!,
    clientSecret: process.env.GITHUB_CLIENT_SECRET!,
  },
  discord: {
    clientId: process.env.DISCORD_CLIENT_ID!,
    clientSecret: process.env.DISCORD_CLIENT_SECRET!,
  },
}
```

#### **SÃ©curitÃ© & Rate Limiting :**
```typescript
// Protection contre les attaques
rateLimit: {
  window: 60, // fenÃªtre de 60 secondes  
  max: 100,   // max 100 requÃªtes par minute
  customRules: {
    "/sign-in/*": { window: 60, max: 5 },    // 5 tentatives login/min
    "/sign-up/*": { window: 300, max: 3 },   // 3 inscriptions/5min
    "/forgot-password/*": { window: 900, max: 2 }, // 2 reset/15min
  },
},
advanced: {
  useSecureCookies: process.env.NODE_ENV === "production",
  sameSitePolicy: "lax", // ou "strict" pour plus de sÃ©curitÃ©
}
```

#### **Commandes essentielles :**
```bash
# Installation Better Auth
npm install better-auth @auth/prisma-adapter

# GÃ©nÃ©rer secret 64 caractÃ¨res
npx @better-auth/cli secret

# Setup Prisma pour Better Auth
npx prisma generate
npx prisma db push

# DÃ©marrage dÃ©veloppement
npm run dev

# Test production build
npm run build
```

---

## 4. Configuration Base de DonnÃ©es (Prisma + PostgreSQL + Docker)

### **Variables d'environnement requises (.env) :**
```
DATABASE_URL="postgresql://repricer_user:repricer_password@localhost:5432/repricer_db?schema=public"
```

### **Structure de base de donnÃ©es implÃ©mentÃ©e :**
- **SchÃ©ma** : `prisma/schema.prisma` (modÃ¨les User, Account, Session, VerificationToken)
- **Client** : `_shared/database/client.ts` (singleton Prisma avec configuration optimisÃ©e)
- **Types** : `_shared/database/types.ts` (rÃ©export des types Prisma + utilitaires)
- **RequÃªtes** : `_shared/database/queries/[model].ts` (fonctions CRUD organisÃ©es par modÃ¨le)
- **Hook client** : `_shared/hooks/useDatabase.ts` (opÃ©rations cÃ´tÃ© client via API)
- **API** : `/api/users` (endpoints REST pour gestion utilisateurs)
- **Adapter** : NextAuth configurÃ© avec PrismaAdapter pour session DB

### **Commandes essentielles :**
```bash
# Docker
npm run db:start           # DÃ©marre PostgreSQL + pgAdmin
npm run db:stop            # ArrÃªte les conteneurs

# Prisma  
npm run db:generate        # GÃ©nÃ¨re le client TypeScript
npm run db:push           # Synchronise le schÃ©ma avec la DB
npm run db:studio         # Interface graphique Prisma Studio
```

### **AccÃ¨s aux interfaces :**
- **Prisma Studio** : http://localhost:5555 (aprÃ¨s `npm run db:studio`)
- **pgAdmin** : http://localhost:5050 (admin@repricer.com / admin123)

---

## 5. Troubleshooting Base de DonnÃ©es

### **ðŸš¨ PROBLÃˆME COURANT - Conflit Port PostgreSQL :**

**SYMPTÃ”ME :** Erreur Prisma `P1010: User was denied access on the database (not available)` alors que Docker PostgreSQL semble dÃ©marrer correctement.

**CAUSE :** Conflit de port entre PostgreSQL local (Homebrew) et Docker PostgreSQL - les deux tentent d'utiliser le port 5432.

**DIAGNOSTIC :**
```bash
# VÃ©rifier si PostgreSQL local tourne
brew services list | grep postgres

# VÃ©rifier qui utilise le port 5432
lsof -i :5432
```

**SOLUTION :**
```bash
# ArrÃªter PostgreSQL local
brew services stop postgresql@15

# Nettoyer et redÃ©marrer Docker
npm run db:clean
npm run db:start

# Tester Prisma
npx prisma db push
```

**PREVENTION :** Toujours arrÃªter PostgreSQL local avant de dÃ©velopper avec Docker.

### **ðŸš« INTERDICTION ABSOLUE - SQLite :**

**RÃˆGLE IMPÃ‰RATIVE :** Ne JAMAIS suggÃ©rer ou utiliser SQLite comme solution de contournement.

**CONTEXTE :** Quand l'IA galÃ¨re avec PostgreSQL, elle propose souvent SQLite comme "solution rapide".

**POURQUOI C'EST INTERDIT :**
- Le projet est conÃ§u pour PostgreSQL en production
- Better Auth nÃ©cessite PostgreSQL pour certaines fonctionnalitÃ©s
- SQLite cache les vrais problÃ¨mes de configuration
- Migration SQLite â†’ PostgreSQL = galÃ¨re assurÃ©e

**EN CAS DE PROBLÃˆME DB :** 
1. Diagnostiquer le problÃ¨me rÃ©el (conflit port, Docker, etc.)
2. RÃ©soudre la cause racine
3. JAMAIS de solution SQLite temporaire

---

## 6. RÃ¨gles de DÃ©veloppement

### **Ã‰viter npm run dev automatique :**
- **RÃˆGLE IMPÃ‰RATIVE** : Ne PAS exÃ©cuter `npm run dev` aprÃ¨s chaque modification
- **Contexte** : L'utilisateur a gÃ©nÃ©ralement dÃ©jÃ  l'application lancÃ©e sur le port 3000
- **Exception** : Lancer `npm run dev` UNIQUEMENT si c'est explicitement nÃ©cessaire pour tester une fonctionnalitÃ© critique
- **Bonne pratique** : Indiquer simplement que les modifications ont Ã©tÃ© apportÃ©es et sont prÃªtes Ã  Ãªtre testÃ©es

### **Ã‰viter npm run build automatique :**
- **RÃˆGLE IMPÃ‰RATIVE** : Ne PAS exÃ©cuter `npm run build` automatiquement aprÃ¨s chaque modification
- **Contexte** : Les builds sont coÃ»teux en temps et l'utilisateur prÃ©fÃ¨re les contrÃ´ler manuellement
- **Exception** : ExÃ©cuter `npm run build` UNIQUEMENT si explicitement demandÃ© par l'utilisateur ou si critique pour valider des changements majeurs
- **Bonne pratique** : Faire confiance aux linters et Ã  TypeScript pour dÃ©tecter les erreurs sans build complet

### **Ã‰viter la crÃ©ation de documentation automatique :**
- **RÃˆGLE IMPÃ‰RATIVE** : Ne JAMAIS crÃ©er de fichiers de documentation (.md, README, etc.) Ã  moins que l'utilisateur le demande explicitement
- **Contexte** : L'utilisateur gÃ¨re sa propre documentation et n'a pas besoin de fichiers supplÃ©mentaires non sollicitÃ©s
- **Exception** : CrÃ©er de la documentation UNIQUEMENT si c'est explicitement demandÃ© par l'utilisateur
- **Bonne pratique** : Se concentrer sur le code fonctionnel plutÃ´t que sur la documentation

### **Code propre - Commentaires et logs :**
- **RÃˆGLE IMPÃ‰RATIVE** : Ne JAMAIS ajouter de commentaires ou de logs console dans le code
- **Contexte** : Le code doit rester propre et lisible sans commentaires superflus
- **Interdictions** :
  - `console.log()`, `console.error()`, `console.warn()`, etc.
  - Commentaires `//` ou `/* */` explicatifs
  - Commentaires JSX `{/* */}`
  - Logs de debug ou de dÃ©veloppement
- **Exception UNIQUE** : Ajouter des commentaires/logs UNIQUEMENT si l'utilisateur le demande explicitement
- **Outils disponibles** : Utiliser `npm run clean:code` pour nettoyer automatiquement le code existant (script dans `scripts/cleanup-code.js`)
- **Bonne pratique** : Ã‰crire du code auto-documentÃ© avec des noms de variables et fonctions explicites

### **Gestion Git et dÃ©ploiement :**
- **RÃˆGLE IMPÃ‰RATIVE** : Ne JAMAIS exÃ©cuter `git push`
- **Contexte** : L'utilisateur gÃ¨re lui-mÃªme les push depuis GitHub Desktop
- **Autorisation** : Commits locaux (`git add` + `git commit`) autorisÃ©s pour organiser le travail
- **DÃ©ploiement** : Utiliser `./deploy.sh` pour dÃ©ployer sur le VPS aprÃ¨s que l'utilisateur ait pushÃ©

### **Couleurs et design :**
- **RÃˆGLE IMPÃ‰RATIVE** : TOUJOURS utiliser les couleurs CSS personnalisÃ©es dÃ©finies dans `src/app/globals.css`
- **Contexte** : Le projet utilise un systÃ¨me de couleurs cohÃ©rent avec support automatique du dark mode
- **Utilisation** : Utiliser les classes Tailwind correspondantes : `bg-background`, `text-foreground`, `border-border`, etc.
- **Interdictions** :
  - Couleurs hardcodÃ©es : `#ffffff`, `rgb(255,255,255)`, `hsl(0,0%,100%)`, etc.
  - Classes Tailwind avec couleurs fixes : `bg-white`, `text-black`, `border-gray-200`, etc.
- **Exception** : Utiliser des couleurs hardcodÃ©es UNIQUEMENT si explicitement demandÃ© par l'utilisateur
- **Bonne pratique** : Respecter le systÃ¨me de design pour maintenir la cohÃ©rence visuelle et le support automatique des thÃ¨mes

### **Espacement et layout :**
- **RÃˆGLE IMPÃ‰RATIVE** : PrivilÃ©gier l'utilisation de `gap` pour l'espacement entre Ã©lÃ©ments
- **Contexte** : `gap` est plus moderne, prÃ©visible et maintenable que `space-*`, `margin` ou `padding` pour l'espacement entre Ã©lÃ©ments
- **Utilisation recommandÃ©e** :
  - `flex flex-col gap-4` au lieu de `space-y-4`
  - `flex gap-2` au lieu de marges entre Ã©lÃ©ments
  - `grid gap-6` pour les grilles
- **Garder `margin` et `padding` uniquement pour** :
  - L'espacement interne d'un composant (`p-4`, `px-6`, `py-3`)
  - Les positionnements absolus (`mb-2` pour dÃ©caler un Ã©lÃ©ment spÃ©cifique)
  - Les cas oÃ¹ `gap` ne s'applique pas (Ã©lÃ©ments non dans un container flex/grid)
- **Bonne pratique** : Utiliser `gap` dÃ¨s qu'on a plusieurs Ã©lÃ©ments enfants Ã  espacer dans un conteneur
